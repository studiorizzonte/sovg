<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOG Virtual Gallery</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: sans-serif; background-color: #272727; }
        .container { width: 100%; height: 100vh; display: flex; flex-direction: column; align-items: center; }
        h1 { padding: 20px; margin: 0; color: white; }
        iframe { width: 90%; height: 80%; border: 1px solid #ccc; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>SOG Virtual Gallery</h1>
        <iframe id="splat-viewer-frame" src=""></iframe>
    </div>

    <script>
        // This script is "clean" and contains no URL paths.
        window.onload = function() {
            // Step 1: Fetch the configuration data
            fetch('config.json')
                .then(response => response.json())
                .then(config => {
                    // Step 2: Build the URLs using the fetched data
                    const repo = config.repositoryName;
                    const model = config.modelPath;

                    const viewerUrl = `/${repo}/splat-viewer/dist/index.html`;
                    const contentUrl = `/${repo}/${model}`;
                    const finalSrc = `${viewerUrl}?content=${contentUrl}`;
                    
                    // Step 3: Set the iframe source
                    const iframe = document.getElementById('splat-viewer-frame');
                    if (iframe) {
                        iframe.src = finalSrc;
                    }
                })
                .catch(error => {
                    console.error('Failed to load configuration:', error);
                    // Display an error to the user if config.json fails to load
                    document.body.innerHTML = '<h1>Error: Could not load site configuration.</h1>';
                });
        };
    </script>
</body>
</html>